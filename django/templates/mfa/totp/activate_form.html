{% extends "main/main.html" %}
{% block title %} vBrowser - Activate Authenticator App{% endblock %}
{% load static %}
{% load i18n %}
{% load account socialaccount %}
{% block styles %}
{% endblock %}
{% block content %}

{% include 'main/nav2.html' %}

<!-- Page content -->
<section class="position-relative h-100 pt-5 pb-4">
  <div class="container d-flex flex-wrap justify-content-center justify-content-xl-start h-100 pt-5">
    <div class="w-100 align-self-end pt-1 pt-md-4 pb-4" style="max-width: 526px;">
      <h1 class="text-center text-xl-start">{% translate "Activate Authenticator App" %}</h1>
      <p class="text-center text-xl-start pb-3 mb-3">
        {% blocktranslate %}To protect your account with two-factor authentication, scan the QR code below with your authenticator app. Then, input the verification code generated by the app below.{% endblocktranslate %}
      </p>
      <form action="{% url 'mfa_activate_totp' %}" method="post" class="needs-validation mb-2">
        {% csrf_token %}
        <!-- Display QR code -->
        <div class="mb-3 text-center">
          {{ totp_svg|safe }}
        </div>
        <!-- Secret field (disabled) -->
        <div class="mb-3">
          <label class="form-label">{% trans "Secret" %}</label>
          <input type="text" name="secret" class="form-control form-control-lg" value="{{ form.secret }}" disabled>
          <p class="small text-muted">
            {% trans "You can store this secret and use it to reinstall your authenticator app at a later time." %}
          </p>
        </div>
        <!-- Render any additional visible fields (excluding 'secret') -->
        {% for field in form.visible_fields %}
          {% if field.name != "secret" %}
            <div class="mb-3">
              {{ field.label_tag }}
              {{ field }}
              {% if field.help_text %}
                <p class="help small">{{ field.help_text }}</p>
              {% endif %}
              {{ field.errors }}
            </div>
          {% endif %}
        {% endfor %}
        <button type="submit" class="btn btn-primary shadow-primary btn-lg w-100">
          {% trans "Activate" %}
        </button>
      </form>
    </div>
  </div>
  
  <!-- Background -->
  <div class="position-absolute top-0 end-0 w-50 h-100 bg-position-center bg-repeat-0 bg-size-cover d-none d-xl-block"
       style="background-image: url('{% static 'assets/img/account/signin-bg.jpg' %}');"></div>
</section>

{% endblock %}
